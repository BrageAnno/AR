<!DOCTYPE html>
<html>
<head>
  <title>Inside Sphere Viewer</title>
  <script src="aframe.min.js"></script> <!-- Include A-Frame library -->
</head>
<body>
  <a-scene device-orientation-permission-ui>
    <!-- Import your existing .glb file -->
    <a-entity id="sphere" gltf-model="./360_HDRI_Test.glb" rotation="0 0 0"></a-entity>

    <!-- Place the camera inside the sphere -->
    <a-entity camera position="0 0 0"></a-entity>
  </a-scene>

  <script>
    // Function to adjust the rotation dynamically
    function adjustRotation(alpha) {
      var sphere = document.getElementById('sphere');
      var rotation = sphere.getAttribute('rotation');
      rotation.y = (360 - alpha) % 360;
      sphere.setAttribute('rotation', rotation);
    }

    // Listen for device orientation events
    window.addEventListener('deviceorientation', function(event) {
      var alpha = event.alpha; // Compass direction in degrees
      adjustRotation(alpha);
    });

    // Calculate initial rotation when the page loads
    window.addEventListener('load', function() {
      if (window.DeviceOrientationEvent) {
        // If device orientation event is supported, use it to set initial rotation
        window.addEventListener('deviceorientation', function(event) {
          var alpha = event.alpha; // Compass direction in degrees
          var sphere = document.getElementById('sphere');
          var rotation = sphere.getAttribute('rotation');
          rotation.y = (360 - alpha) % 360;
          sphere.setAttribute('rotation', rotation);
          // Remove the event listener once initial rotation is set
          window.removeEventListener('deviceorientation', arguments.callee);
        });
      } else {
        // If device orientation event is not supported, fallback to a default initial rotation
        var sphere = document.getElementById('sphere');
        var rotation = sphere.getAttribute('rotation');
        rotation.y = 0; // Default initial rotation (adjust as needed)
        sphere.setAttribute('rotation', rotation);
      }
    });
  </script>
</body>
</html>