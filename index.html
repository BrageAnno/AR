<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>360 HDRI Test</title>
  <script src="aframe.min.js"></script>
</head>
<body>
  <a-scene background="color: #ECECEC">
    <!-- 360 HDRI Sphere -->
    <a-sky id="hdri-sphere" src="./360_HDRI_Test.glb" rotation="0 -90 0"></a-sky>

    <!-- Camera -->
    <a-entity id="camera" camera look-controls position="0 0 0"></a-entity>
  </a-scene>

  <script>
    const hdriSphere = document.querySelector("#hdri-sphere");
    const camera = document.querySelector("#camera");
    let compass;

    function startCompass() {
      window.addEventListener("deviceorientation", handler, true);
    }

    function handler(e) {
      compass = e.webkitCompassHeading || Math.abs(e.alpha - 360);
      if (compass !== undefined && compass !== null) {
        hdriSphere.setAttribute("rotation", `0 ${compass - 90} 0`);
        camera.setAttribute("rotation", `0 ${compass} 0`);
      }
    }

    startCompass();
  </script>
</body>
</html>